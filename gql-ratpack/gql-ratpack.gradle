apply plugin: 'groovy'
apply plugin: 'jacoco'
apply plugin: 'maven-publish'

dependencies {
  compile project(':gql-core')
  compile "io.ratpack:ratpack-core:$ratpack"
  compile "io.ratpack:ratpack-guice:$ratpack"

  testCompile "io.ratpack:ratpack-groovy-test:$ratpack"
  testCompile "org.spockframework:spock-core:$spock"
  testCompile 'org.objenesis:objenesis:2.1'
}

task sourcesJar(type: Jar, dependsOn: classes) {
  classifier = 'sources'
  from sourceSets.main.allSource
}

artifacts {
  archives sourcesJar
}

publishing {
  publications {
    'gql-ratpack'(MavenPublication) {
      groupId    "$releaseGroup"
      artifactId 'gql-ratpack'
      version    "$releaseVersion"

      from components.java
      artifact sourcesJar
    }
  }
}

task('console', type: JavaExec) {
    main = 'groovy.ui.Console'
    project.dependencies.add("compile", 'org.codehaus.groovy:groovy-all:2.4.12')
    classpath = sourceSets.main.runtimeClasspath
}
